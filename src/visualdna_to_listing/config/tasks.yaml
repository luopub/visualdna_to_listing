market_intelligence_task:
  description: |
    Start by prompting the user to input a product name with tool user_input_tool.
    Then, ask user to input some key information about the product, such as its price point, target audience, and competitors.
    Conduct an in-depth search for the product on Amazon, Walmart, and relevant tech/lifestyle review blogs. 
    1. Identify the top 3 competitors and their core Unique Selling Propositions (USPs).
    2. Extract at least 10 authentic user scenarios (e.g., "using the lamp at 2 AM for coding").
    3. List the top 5 recurring complaints or anxieties mentioned by buyers.
    4. Observe the visual style of high-performing competitors (lighting, background, angles).
  expected_output: >
    A structured report in markdown format that containing competitor analysis, a prioritized list of customer pain points, and a library of real-world usage scenarios.
  agent: product_research_specialist

resource_kit_generation_task:
  description: |
    Based on the intelligence gathered, populate the 'Product Image Toolkit v3.0' template. You must:
    1. Define 'Scenario Context' based on real user habits (e.g., 'Messy desk' vs 'Minimalist office').
    2. Select 'Visual Mood Keywords' that contrast with competitor weaknesses.
    3. Design at least 3 specific 'Composition Perspectives' that visually debunk the top 5 customer anxieties (e.g., if users fear size issues, suggest a shot with a known reference object like a smartphone).
    4. Specify 'Negative Elements' to avoid based on identified market cliches.
  expected_output: >
    A detailed finalized Product Resource Kit in Markdown format for the specified product category.
  agent: strategic_visual_planner

collect_product_info_task:
  description: |
    1. Read all contents of resource kit file "resource_kit_researched.md" to understand the current product researched context. If it cannot be read all at once, please read it repeatedly in cycles until it is fully read.
    2. Prompt the user to provide the following essential information one at a time:
       - At least one or more product reference photo file paths (absolute paths to actual product photos, one path at a time, empty string for end of input). Remove duplicated paths if exist.
       - Product-specific parameters that differentiate this product from competitors:
         * Size list (e.g., Small/Medium/Large dimensions)
         * Material composition (e.g., 100% cotton canvas, polyester blend)
         * Color variants available
         * Any other product parameters that are helpful to differentiate this product from others.
    3. Refine the resource kit:
       - Add reference photo file paths in a new "Reference Product Photos" section.
       - Remove or revise content that is conflicting with the photo or product parameters provided by the user.
       - Add detailed product parameters in the "Basic Product Facts" section
  expected_output: |
    The refined resource kit updated with all product-specific information from user input in markdown format.
  agent: product_info_collector

reference_photo_description_task:
  description: |
    Get the reference photo file paths from the resource kit. Then, for each photo, generate a description in reference text in less tha 100 words and put the description under the corresponding photo file path in the "Reference Product Photos" section.
  expected_output: |
    A refined resource kit with all reference photo file paths and descriptions in markdown format.
  agent: product_info_collector

confirm_and_save_facts_task:
  description: |
    Review the update resource kit and extract all facts that may affect the product listing. Then prompt user to confirm them one by one, and take action on user input.
       - If user confirms a fact, keep it in the resource kit. (User input empty string)
       - If user rejects a fact, remove it from the resource kit. (User input "reject" or "r", case-insensitive)
       - If user provides additional information or corrections, update the resource kit accordingly. (User input is the new fact or correction)
  expected_output: |
    The final confirmed resource kit with all facts validated by the user.
  agent: product_info_collector

define_visual_dna_task:
  description: |
    1. Parse the provided resource_kit_refined.md, specifically extracting the "Primary Mood Palette" and "Lighting Specifications".
    2. Identify "Negative Elements to Avoid" (e.g., no white backgrounds, no adult models) to differentiate from competitors.
    3. Define the core visual signature based on the data extracted in step 1.
  expected_output: >
    A Visual DNA Specification document that locks in the lighting, texture requirements, and color palette.
  agent: visual_dna_architect

plan_and_write_prompts_task:
  description: |
    1. Develop 10 detailed image generation prompts based on content of file resource_kit_refined.md and visual_dna_specification.
    2. MANDATORY DATA INTEGRATION: Each prompt must incorporate specific details from the 'Basic Product Facts' (e.g., Dual-purpose storage, double-stitching).
    3. MATERIAL FIDELITY: Every prompt must reference the physical file paths (e.g., simulate-1.png) and describe the textures found in the 'Raw Materials' section (e.g., large-gauge zipper, 300L capacity).
    4. SCENARIO ALIGNMENT: Use the 'Scenario Context' table to build the 10-image set, specifically focusing on Scenarios.
    5. ANXIETY DEBUNKING: Implement the "Composition Perspectives" (1-6) to address customer fears.
    6. The prompts must follow the referenced reference photos in terms of visual characteristics and details. Do not add additional parts onto the reference photos.
    7. At least one reference photos must be selected and explicitly referenced in the prompts to ensure the generated images reflect the real outlook and qualities of the product.
    8. Any text that will be shown on the image must be in English.
    9. First prompt must be a "Hero Shot" that focuses on the most important product USPs.
  expected_output: |
    A list of 10 structured prompts. Each prompt must include: 
    - Scene Name (e.g., The Honest Hero Shot)
    - Reference Image Paths (One or more, selected from Resource Kit reference photos list)
    - Detailed description of product USPs
    - Targeted Aspect Ratio 1:1.
  agent: creative_prompt_engineer

image_prompts_review_task:
  description: |
    Review the 10 prompts produced in the previous task. Ensure each prompt is well-structured and references at least one reference photo.
    - If a prompt is missing a reference image, load file resource_kit_refined.md to find one or more suitable reference photos.
    If all prompts are well-structured, approve them for image generation without change.
    Do not modify the prompts text.
  expected_output: |
    A list of 10 well-structured prompts. Each prompt must include:
    - Reference Image Paths (One or more, selected from Resource Kit reference photos list)
    - Prompt text for image generation
  agent: creative_prompt_engineer

generate_listing_images_task:
  description: |
    Execute the 10 prompts produced in the previous task. Ensure each target image is named according to the Scene Name with valid filename characters and are numbered sequentially.
    Calling to image generator must match the args_schema defined for the tool, not bare string.
    Reference images must be pass to the generator call as a list of file paths.
  expected_output: >
    10 high-resolution image file names saved locally by generator.
  agent: image_production_specialist